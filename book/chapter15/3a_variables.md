# Переменные

Прежде, чем мы приступим к знакомству с модулями, которые работают с сетевым оборудованием, нам нужно разобраться с тем, как создавать переменные в playbook.

Переменной может быть информация, которую мы собрали об устройстве, а затем использовали её в шаблоне.

В переменные мы можем записывать полученный вывод команды.

А в работе с модулями, которые работают с сетевым оборудованием, нам нужно указать ряд параметров, которые также удобно создать как переменные.

## Имена переменных

В Ansible есть определенные ограничения по формату имен переменных:
* Переменные могут состоять из букв, чисел и символа ```_```
* Переменные должны начинаться с буквы

Кроме того, мы можем создавать словари с переменными (в формате YAML):
```
R1:
  IP: 10.1.1.1/24
  DG: 10.1.1.100
```

Обращаться к переменным в словаре можно двумя вариантами:
```
R1['IP']
R1.IP
```

Правда, при использовании второго варианта, могут быть проблемы, если название ключа совпадает с зарезервированным словом (методом или атрибутом) в Python или Ansible.

## Где можно определять переменные

Переменные можно создавать:
* в инвентарном файле
* в playbook
* в специальных файлах для группы/устройства
* в отдельных файлах, которые добавляются в playbook через include (как в Jinja2)
* в ролях, которые затем используются
* можно даже передавать переменные при вызове playbook

Также можно использовать факты, которые были собраны про устройство, как переменные.

Мы посмотрим на разные варианты. Лучше всего хранить переменные в отдельных файлах, но, в некоторых случаях, переменные удобно указывать в playbook.

### Переменные в инвентарном файле

Например, с помощью переменных можно указать IP-адрес и порт устройства.

```
R1 ansible_host=192.168.100.1
R2 ansible_host=192.168.100.2
R3 ansible_host=192.168.100.3

SW1 ansible_host=192.168.100.100  ansible_port=22022
```

Теперь можно обращаться к устройствам по имени: R1, R2, R3, SW1.
А, при обращении на коммутатор SW1, будет использоваться порт 22022.

Также в инвентарном файле можно указывать переменные для группы:
```
[cisco-routers]
192.168.100.1
192.168.100.2
192.168.100.3

[cisco-switches]
192.168.100.100

[cisco-routers:vars]
ntp_server=192.168.255.100
log_server=10.255.100.1
```

Переменые ntp_server и log_server относятся к группе cisco-routers и могут использоваться, например, при генерации конфигурации, на основе шаблона.


### Переменные в playbook

Переменные можно задавать прямо в playbook. Это может быть удобно тем, что переменные находятся там же, где все действия.

Например, можно задать переменные ntp_server и log_server в playbook таким образом:
```
---

- name: Run show commands on routers
  hosts: cisco-routers
  gather_facts: false

  vars:
    ntp_server: 192.168.255.100
    log_server: 10.255.100.1

  tasks:

    - name: run sh ip int br        
      raw: sh ip int br | ex unass

    - name: run sh ip route
      raw: sh ip route

```

### Переменные в специальных файлах для группы/устройства
