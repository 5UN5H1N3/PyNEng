#Ansible

Ansible - это система управления конфигурациями. Ansible позволяет автоматизировать и упростить настройку, обслуживание и развертывание серверов, служб, ПО и др.

На данный момент существует несколько [систем управления конфигурациями](http://xgu.ru/wiki/%D0%A1%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0_%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B5%D0%B9).

Однако, для работы с сетевым оборудованием, чаще всего используется Ansible.
Связано это с тем, что Ansible не требует установки агента на управляемые хосты.
Особенно актуально это для устройств, которые позволяют работать с ними только через CLI.

> Некоторое оборудование поддерживает другие системы управления конфигурациями (позволяет установить агента).

Одно из важный преимуществ Ansible заключается в том, что он очень прост в использовании. И его довольно легко начать использовать.

Прежде чем мы начнем разбираться подробнее с Ansible, перечислим несколько вещей, которые Ansible решит, в контексте использования его для работы с сетевым оборудованием:
* подключение по SSH к устройствам
 * паралелльное подключение к устройствам по SSH (можно указывать ко скольки устройствам подключаться одновременно)
* отправка команд на устройства
* удобный синтаксис описания устройств:
 * можно разбивать устройства на группы и затем отправлять какие-то команды на всю группу
* поддержка шаблонов конфигараций с Jinja2

Это всего лишь несколько возможностей Ansible, которые относятся к сетевому оборудованию. Они перечислены тут, для того чтобы показать, что эти задачи Ansible сразу снимает и можно не использовать для этого какие-то скрипты, так как с Ansible это можно сделать намного удобней.

Теперь разберемся с Ansible более формально.

## Основы Ansible
Ansible:
* Работает без установки агента на управляемые хосты
* Использует SSH для подключения к управляемым хостам
* Выполняет изменения, с помощью модулей Python, которые выполняются на управляемых хостах
* Может выполнять действия локально, на управляющем хосте
* Использует YAML для описания сценариев
* Содержит множество модулей (их количество постоянно растет)
* Легко писать свои модули

### Терминология
* __Control machine__ —  управляющий хост. Сервер Ansible, с которого происходит управление другими хостами
* __Manage node__ —  управляемые хосты
* __Inventory__ —  инвентарный файл. В этом файле описываются хосты, группы хостов. А также могут быть созданы переменные
* __Playbook__ — файл сценариев
* __Play__ —  сценарий (набор действий). Связывает несколько действий с хостами, для которых эти действия надо выполнить
* __Task__ —  действие. Вызывает модуль с указанными параметрами и переменными
* __Module__ — модуль Ansible. Реализует определенные функции

### Варианты подключения к управляемым хостам
Ansible поддерживает такие типы подключений:
* __paramiko__ - Python SSH модуль
* __SSH__ - OpenSSH
* __local__ - действия выполняются локально, на управляющем хосте

По умолчанию используется OpenSSH. Но, можно указать, что нужно использовать paramiko.

При подключении по SSH, по умолчанию предполагается использование SSH ключей. Но, при желании, можно переключиться на использование паролей.


Для выполнения действий на управляемых хостах, Ansible загружает на хост модуль Python и выполняет его.

Однако, это не единственный вариант работы с управляемыми хостами.
Ansible может выполнять модули Python и локально, на управляющем хосте.
